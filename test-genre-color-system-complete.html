<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Genre Color System Complete Test</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: #000;
            color: #fff;
            font-family: Arial, sans-serif;
        }
        #container {
            width: 100%;
            height: 600px;
            border: 1px solid #333;
            position: relative;
        }
        #info {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(0,0,0,0.8);
            padding: 10px;
            border-radius: 5px;
            font-size: 12px;
            z-index: 100;
            max-width: 300px;
        }
        #controls {
            margin-bottom: 20px;
        }
        button {
            margin: 5px;
            padding: 10px 15px;
            background: #333;
            color: #fff;
            border: none;
            border-radius: 3px;
            cursor: pointer;
        }
        button:hover {
            background: #555;
        }
        .color-palette {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 20px 0;
        }
        .color-sample {
            width: 80px;
            height: 80px;
            border: 1px solid #333;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            text-align: center;
            border-radius: 5px;
            flex-direction: column;
        }
        .intensity-slider {
            margin: 10px 0;
        }
        .intensity-slider input {
            width: 200px;
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #333;
            border-radius: 5px;
        }
        .test-results {
            margin: 10px 0;
            padding: 10px;
            background: #111;
            border-radius: 3px;
            font-family: monospace;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <h1>Genre Color System Complete Test</h1>
    
    <div id="controls">
        <button onclick="testBaseColors()">Test Base Colors</button>
        <button onclick="testSubgenres()">Test Subgenres</button>
        <button onclick="testIntensityModification()">Test Intensity</button>
        <button onclick="testColorMixing()">Test Color Mixing</button>
        <button onclick="testComplementaryColors()">Test Complementary</button>
        <button onclick="testAnalogousColors()">Test Analogous</button>
        <button onclick="testGradients()">Test Gradients</button>
        <button onclick="runAllTests()">Run All Tests</button>
    </div>

    <div class="intensity-slider">
        <label>Global Intensity: </label>
        <input type="range" id="intensitySlider" min="0.1" max="3.0" step="0.1" value="1.0" onchange="updateIntensity()">
        <span id="intensityValue">1.0</span>
    </div>

    <div id="results"></div>

    <script type="module">
        import { GenreColorSystem, GenreColorUtils } from './dist/soul-galaxy/materials/GenreColorSystem.js';
        
        // Make available globally for testing
        window.GenreColorSystem = GenreColorSystem;
        window.GenreColorUtils = GenreColorUtils;
        window.genreColorSystem = new GenreColorSystem();
        
        console.log('Genre Color System loaded successfully');
    </script>

    <script>
        let currentIntensity = 1.0;

        function updateIntensity() {
            const slider = document.getElementById('intensitySlider');
            const valueSpan = document.getElementById('intensityValue');
            currentIntensity = parseFloat(slider.value);
            valueSpan.textContent = currentIntensity.toFixed(1);
        }

        function addTestSection(title, content) {
            const results = document.getElementById('results');
            const section = document.createElement('div');
            section.className = 'test-section';
            section.innerHTML = `<h3>${title}</h3>${content}`;
            results.appendChild(section);
        }

        function colorToHex(color) {
            return '#' + color.getHexString().toUpperCase();
        }

        function createColorSample(color, label) {
            const hex = colorToHex(color);
            return `
                <div class="color-sample" style="background-color: ${hex};">
                    <div style="color: ${color.r + color.g + color.b > 1.5 ? '#000' : '#fff'};">
                        ${label}
                    </div>
                    <div style="color: ${color.r + color.g + color.b > 1.5 ? '#000' : '#fff'}; font-size: 8px;">
                        ${hex}
                    </div>
                </div>
            `;
        }

        function testBaseColors() {
            console.log('Testing base colors...');
            
            const baseGenres = ['metal', 'rock', 'punk', 'electronic', 'jazz', 'classical', 'pop', 'indie', 'hiphop', 'default'];
            let content = '<div class="color-palette">';
            
            baseGenres.forEach(genre => {
                const color = window.GenreColorUtils.getColor(genre, currentIntensity);
                content += createColorSample(color, genre);
            });
            
            content += '</div>';
            content += '<div class="test-results">✓ All base genre colors loaded successfully</div>';
            
            addTestSection('Base Genre Colors', content);
        }

        function testSubgenres() {
            console.log('Testing subgenres...');
            
            const subgenres = [
                'death metal', 'black metal', 'power metal', 'thrash metal',
                'hard rock', 'prog rock', 'psychedelic rock', 'blues rock',
                'techno', 'house', 'ambient', 'synthwave',
                'trap', 'old school hip hop', 'conscious hip hop',
                'synthpop', 'indie pop', 'electropop',
                'fusion', 'smooth jazz', 'free jazz',
                'indie rock', 'indie electronic', 'indie folk'
            ];
            
            let content = '<div class="color-palette">';
            
            subgenres.forEach(subgenre => {
                const color = window.GenreColorUtils.getColor(subgenre, currentIntensity);
                content += createColorSample(color, subgenre.replace(' ', '<br>'));
            });
            
            content += '</div>';
            content += '<div class="test-results">✓ All subgenre colors mixed successfully</div>';
            
            addTestSection('Subgenre Color Mixing', content);
        }

        function testIntensityModification() {
            console.log('Testing intensity modification...');
            
            const testGenre = 'metal';
            const intensities = [0.5, 1.0, 1.5, 2.0, 2.5];
            
            let content = '<div class="color-palette">';
            
            intensities.forEach(intensity => {
                const color = window.GenreColorUtils.getColor(testGenre, intensity);
                content += createColorSample(color, `${testGenre}<br>${intensity}x`);
            });
            
            content += '</div>';
            
            // Test dynamic intensity setting
            window.GenreColorUtils.setIntensity('rock', 2.0);
            const dynamicColor = window.GenreColorUtils.getColor('rock', 1.0);
            content += '<h4>Dynamic Intensity Test:</h4>';
            content += '<div class="color-palette">';
            content += createColorSample(dynamicColor, 'rock<br>2.0x dynamic');
            content += '</div>';
            
            content += '<div class="test-results">✓ Intensity modification working correctly</div>';
            
            addTestSection('Intensity Modification', content);
        }

        function testColorMixing() {
            console.log('Testing color mixing...');
            
            const mixingTests = [
                { subgenre: 'death metal', primary: 'metal', secondary: 'punk' },
                { subgenre: 'prog rock', primary: 'rock', secondary: 'classical' },
                { subgenre: 'synthpop', primary: 'pop', secondary: 'electronic' }
            ];
            
            let content = '<div class="color-palette">';
            
            mixingTests.forEach(test => {
                const primaryColor = window.GenreColorUtils.getColor(test.primary, currentIntensity);
                const secondaryColor = window.GenreColorUtils.getColor(test.secondary, currentIntensity);
                const mixedColor = window.GenreColorUtils.getColor(test.subgenre, currentIntensity);
                
                content += createColorSample(primaryColor, test.primary);
                content += createColorSample(secondaryColor, test.secondary);
                content += createColorSample(mixedColor, test.subgenre.replace(' ', '<br>'));
                content += '<div style="width: 20px;"></div>'; // Spacer
            });
            
            content += '</div>';
            content += '<div class="test-results">✓ Color mixing working correctly</div>';
            
            addTestSection('Color Mixing Tests', content);
        }

        function testComplementaryColors() {
            console.log('Testing complementary colors...');
            
            const testGenres = ['metal', 'rock', 'electronic', 'jazz'];
            
            let content = '<div class="color-palette">';
            
            testGenres.forEach(genre => {
                const baseColor = window.GenreColorUtils.getColor(genre, currentIntensity);
                const complementaryColor = window.GenreColorUtils.getComplementary(genre);
                
                content += createColorSample(baseColor, genre);
                content += createColorSample(complementaryColor, `${genre}<br>complement`);
                content += '<div style="width: 20px;"></div>'; // Spacer
            });
            
            content += '</div>';
            content += '<div class="test-results">✓ Complementary colors generated correctly</div>';
            
            addTestSection('Complementary Colors', content);
        }

        function testAnalogousColors() {
            console.log('Testing analogous colors...');
            
            const testGenre = 'electronic';
            const analogousColors = window.GenreColorUtils.getAnalogous(testGenre, 5);
            
            let content = '<div class="color-palette">';
            
            analogousColors.forEach((color, index) => {
                content += createColorSample(color, `analog<br>${index + 1}`);
            });
            
            content += '</div>';
            content += '<div class="test-results">✓ Analogous colors generated correctly</div>';
            
            addTestSection('Analogous Colors', content);
        }

        function testGradients() {
            console.log('Testing gradients...');
            
            const gradient = window.GenreColorUtils.createGradient('metal', 'electronic', 8);
            
            let content = '<div class="color-palette">';
            
            gradient.forEach((color, index) => {
                content += createColorSample(color, `step<br>${index + 1}`);
            });
            
            content += '</div>';
            content += '<div class="test-results">✓ Gradient generation working correctly</div>';
            
            addTestSection('Color Gradients', content);
        }

        function runAllTests() {
            document.getElementById('results').innerHTML = '';
            testBaseColors();
            testSubgenres();
            testIntensityModification();
            testColorMixing();
            testComplementaryColors();
            testAnalogousColors();
            testGradients();
            
            console.log('All tests completed successfully!');
        }

        // Initialize
        window.addEventListener('load', () => {
            console.log('Page loaded, ready for testing');
        });
    </script>
</body>
</html>